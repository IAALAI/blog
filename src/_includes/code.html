<link rel="preload" href="/dark+.json" as="fetch" type="application/json" crossorigin="anonymous">
<script defer type="module">
import * as monaco from "//cdn.jsdelivr.net/npm/monaco-editor/+esm";
fetch("/dark+.json").then(res => res.json()).then(async rules => {
    monaco.editor.defineTheme("ia", {
        base: "vs-dark",
        inherit: true,
        rules,
        colors: {
            "editor.background": "#282828",
            "editorGutter.background": "#282828",
            "menu.background": "#434343",
            "menu.border": "#7ee777",
            "menu.foreground": "#7ee777",
            "activityBar.activeBackground": "#282828",
            "activityBar.foreground": "#7ee777",
            "sideBar.background": "#212121",
            "sideBar.foreground": "#7ee777",
            "sideBarSectionHeader.background": "#414141",
            "tab.activeBackground": "#414141",
            "tab.activeForeground": "#7ee777",
            "tab.inactiveBackground": "#282828",
            "tab.inactiveForeground": "#7ee77760",
            "editor.selectionBackground": "#7ee77760",
            "editor.selectionForeground": "#7ee777",
            "editor.selectionHighlightBorder": "#7ee77733",
            "editor.selectionHighlightBackground": "#7ee77740",
            "editor.findMatchBackground": "#7ee77760",
            "editor.findMatchHighlightBackground": "#a7afa640",
            "terminal.background": "#333",
            "statusBar.foreground": "#7ee777",
            "statusBar.border": "#7ee777",
            "statusBar.background": "#232323",
        },
    })

    monaco.editor.setTheme("ia");
    debugger
    document.querySelectorAll("code").forEach(async element => {
        for (let i = 0; i < element.classList.length; i++) {
            if (element.classList[i].startsWith("language-")) {
                element.classList.add("monaco")
                element.dataset.lang = element.classList[i].split("-")[1];
                break;
            }
        }
        if (element.dataset.lang) {
            let data = element.innerText.trimRight();
            element.innerHTML = "";
            let editor = monaco.editor.create(element, {
                value: data,
                fontWeight: 300,
                fontFamily: "consolas",
                fontSize: 16,
                scrollBeyondLastLine: false,
                automaticLayout: true,
                language: element.dataset.lang,
                minimap: {
                    enabled: true
                },
            });

async function updateEditorHeight() { 
    var lineHeight = editor.getOption(monaco.editor.EditorOption.lineHeight);
    var lineCount = editor.getModel().getLineCount();
    const height = lineHeight * (lineCount + 1) + 'px';
    element.style.height  = height;
    editor.layout();
}

            updateEditorHeight();
            editor.onDidChangeModelContent(updateEditorHeight);
        }
        /*     if (element.innerText.startsWith("<<<")) {
                element.innerText.substring(4).trim()
            } else {
                target_data = element.innerText
            } */
    })
})
</script>
<style>
    code.monaco {
        display: block;
        height: auto;
        width: 100%;

        &>div {
            padding-top: 1em;
        }
    }
</style>
<link href="https://cdn.jsdelivr.net/npm/vscode-codicons@latest/dist/codicon.min.css" rel="stylesheet">